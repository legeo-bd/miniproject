#include <PMserial.h>
#include <Wire.h>
#include <LiquidCrystal_I2C.h>

SerialPM pms(PMSx003, 2, 3);  // PMSx003, RX=2, TX=3 (as you specified)

const int led = 13;

// I2C LCD - change address to 0x3F if 0x27 doesn't work
LiquidCrystal_I2C lcd(0x27, 16, 2);  // address, columns, rows

void setup() {
  Serial.begin(9600);
  Serial.println("Micro Projects th");
  pms.init();

  pinMode(led, OUTPUT);

  // Initialize LCD
  lcd.init();
  lcd.backlight();
  lcd.clear();

  // Welcome message
  lcd.setCursor(0, 0);
  lcd.print("Air Quality");
  lcd.setCursor(0, 1);
  lcd.print("Monitor");
  delay(2000);
  lcd.clear();
}

void loop() {
  pms.read();

  // Serial Monitor output
  Serial.print(F("PM1.0 ")); Serial.print(pms.pm01); Serial.print(F(", "));
  Serial.print(F("PM2.5 ")); Serial.print(pms.pm25); Serial.print(F(", "));
  Serial.print(F("PM10 ")) ; Serial.print(pms.pm10); Serial.println(F(" [ug/m3]"));

  // LCD Display
  lcd.clear();

  // Line 1: PM2.5 and PM10
  lcd.setCursor(0, 0);
  lcd.print("2.5:");
  lcd.print(pms.pm25);
  lcd.print(" 10:");
  lcd.print(pms.pm10);

  // Line 2: PM1.0
  lcd.setCursor(0, 1);
  lcd.print("1.0:");
  lcd.print(pms.pm01);
  lcd.print(" ug/m3");

  // LED control
  if(pms.pm10 >= 2000){
     digitalWrite(led, HIGH); 
  }
  else if(pms.pm10 < 2000){
     digitalWrite(led, LOW); 
  }

  delay(1000);
}
